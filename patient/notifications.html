<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Notifications - MedPulse</title>
  <link rel="stylesheet" href="patient.css" />
</head>
<body>
  <nav class="navbar">
    <div class="nav-container">
      <h1 class="nav-brand">MedPulse</h1>
      <div class="nav-links">
        <a href="dashboard.html">Dashboard</a>
        <a href="notifications.html" class="active">Notifications</a>
        <a href="change-password.html">Change Password</a>
        <a href="#" onclick="logout()">Logout</a>
      </div>
    </div>
  </nav>

  <div class="dashboard-container">
    <h2>Notifications</h2>
    <button class="btn-primary" onclick="markAllAsRead()">Mark All as Read</button>
    
    <div id="notifications-list" class="notifications-list">
      <!-- Notifications will be loaded here -->
    </div>
  </div>

  <script>
    window.addEventListener('DOMContentLoaded', () => {
      loadNotifications();
    });

    function loadNotifications() {
      const patientId = localStorage.getItem('patientId');
      const notifications = JSON.parse(localStorage.getItem('patientNotifications') || '[]');
      const patientNotifications = notifications.filter(n => n.patientId === patientId);
      const list = document.getElementById('notifications-list');

      if (patientNotifications.length === 0) {
        list.innerHTML = '<p>No notifications.</p>';
        return;
      }

      list.innerHTML = patientNotifications.map(notif => {
        const date = new Date(notif.timestamp);
        return `
          <div class="notification-item ${notif.read ? 'read' : 'unread'}" onclick="markAsRead('${notif.id}')">
            <div class="notification-icon">ðŸ””</div>
            <div class="notification-content">
              <h4>${notif.title}</h4>
              <p>${notif.message}</p>
              <span class="notification-date">${date.toLocaleString()}</span>
            </div>
          </div>
        `;
      }).join('');
    }

    function markAsRead(notificationId) {
      const notifications = JSON.parse(localStorage.getItem('patientNotifications') || '[]');
      const notif = notifications.find(n => n.id === notificationId);
      if (notif) {
        notif.read = true;
        localStorage.setItem('patientNotifications', JSON.stringify(notifications));
        loadNotifications();
      }
    }

    function markAllAsRead() {
      const patientId = localStorage.getItem('patientId');
      const notifications = JSON.parse(localStorage.getItem('patientNotifications') || '[]');
      notifications.forEach(notif => {
        if (notif.patientId === patientId) {
          notif.read = true;
        }
      });
      localStorage.setItem('patientNotifications', JSON.stringify(notifications));
      loadNotifications();
    }

    function logout() {
      if (confirm('Are you sure you want to logout?')) {
        localStorage.removeItem('patientLoggedIn');
        localStorage.removeItem('patientId');
        window.location.href = '../index.html';
      }
    }
  </script>
</body>
</html>

